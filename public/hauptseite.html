<!DOCTYPE html>
<html>

<head>
    <link rel="icon" href="siopicon.png">
    <link rel="stylesheet" href="stylesheet.css">
    <script src="hauptseite.js"></script>

    <title>
        SIOP
    </title>
</head>

<body>
    <span id="Kopfzeile">
        <div align="center" width="100%" height="100px" style="background-color: black">
            <img align="center" width="10%" height="10%" src="./Siop_Icon_Beige.png">
            <p style="color:bisque;">sharing is our passion.</p>
        </div>
    </span>

    <div class="row">
        <div class="column" id="linkespalte">

            <span id="TabelleEintraege">
                <table id="eintraege" border="solid-black"></table>
            </span>

            <script>

                var eintraege = document.getElementById("eintraege");
                let i = 0;

                fetch("/eintrag").then(res => {
                    return res.json();
                }).then(eintrag => {
                    eintrag.forEach(eintrag => {

                        var button = document.createElement("input");
                        button.type = "button";
                        button.id = eintrag.id;
                        button.value = "Löschen";
                        button.onclick= loeschen(button.id);

                        var neueZeile = eintraege.insertRow(i);
                        i++;
                        var neueZelle0 = neueZeile.insertCell(0);
                        var neueZelle1 = neueZeile.insertCell(1);
                        var neueZelle2 = neueZeile.insertCell(2);
                        var neueZelle3 = neueZeile.insertCell(3);
                        var neueZelle4 = neueZeile.insertCell(4);
                        var neueZelle5 = neueZeile.insertCell(5);

                        neueZelle0.innerHTML = eintrag.bezeichnung;
                        neueZelle1.innerHTML = eintrag.beschreibung;
                        neueZelle2.innerHTML = eintrag.ort;
                        neueZelle3.innerHTML = eintrag.benutzer;
                        neueZelle4.innerHTML = eintrag.kategorie;
                        neueZelle5.appendChild(button);

                    });
                });
            </script>
            <span>
        </div>
        <div class="column" id="rechtespalte">
            <form id="neuerEintrag">
                Bezeichnung: </br> <input type="text" name="bezeichnung" id ="bezeichnung" required>
                </br>
                Beschreibung: </br> <input type="text" name="beschreibung" id ="beschreibung" required>
                </br>
                Ort: </br> <input type="text" name="ort" id ="ort" required>
                </br>
                Benutzer: </br> <input type="text" name="benutzer" id ="benutzer" required>
                </br>
                Kategorie: </br> <input type="text" name="kategorie" id ="kategorie" required>
                </br>
                </br>
                <button onclick="window.location.reload();" type="submit" name="hinzufuegen" value="Hinzufügen">Hinzufügen</button>
            
            </form>
            </span>
        </div>
    </div>

    <script>
        const form = document.querySelector('#neuerEintrag');

        form.addEventListener('submit', (event) => {
            event.preventDefault();

            const values = Object.fromEntries(new FormData(event.target));

        fetch("/eintrag", {
            method: 'POST',
            headers: {
                'content-type': 'application/json'
            },
            body: JSON.stringify({id : 11, bezeichnung : document.querySelector("#bezeichnung").value , beschreibung: document.querySelector("#beschreibung").value, ort : document.querySelector("#ort").value, benutzer : document.querySelector("#benutzer").value, kategorie : document.querySelector("#kategorie").value})
        }).then(res => {
            return res.json();
        });
    });

    function loeschen(id) {
        fetch("/eintrag/" + id, {
            method: 'DELETE',
        }).then(() => {
            console.log('removed');
        }).catch(err => {
            console.error(err);
        });
    }

    </script>
</body>

</html>